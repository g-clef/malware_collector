import configparser
import os
import hashlib


class MalwareCollector:
    def __init__(self):
        self.configfile = configparser.ConfigParser()
        self.configfile.read("malware_collector.conf")

    @staticmethod
    def make_hashes(filename):
        if os.path.isdir(filename):
            raise Exception("not a file")
        md5 = hashlib.md5()
        sha1 = hashlib.sha1()
        with open(filename, 'rb') as fileHandle:
            for chunk in iter(lambda: fileHandle.read(65536), b""):
                md5.update(chunk)
                sha1.update(chunk)
        return md5.hexdigest(), sha1.hexdigest()
