import os
from typing import Tuple

from git import Commit
from malware_collector import MalwareCollector


class ZooCollector(MalwareCollector):
    # plan: git checkout https://github.com/ytisf/theZoo/tree/master/malwares/Binaries
    # to the base paththen walk through each folder and unzip the files that contain
    # the actual malware.
    git_url = "https://github.com/ytisf/theZoo.git"

    def __init__(self):
        super(ZooCollector, self).__init__()
        self.base_path = os.environ.get("theZoo_PATH", "/RAID/theZoo")

    def get(self) -> Tuple[bool, Commit]:
        return self.pull_from_repo(self.base_path, self.git_url)


if __name__ == "__main__":
    zooSync = ZooCollector()
    changed, last_commit = zooSync.get()
    print(f"sync complete. New files: {changed}")
    print("done.")
